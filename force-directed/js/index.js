'use strict';var _createClass=function(){function a(b,c){for(var g,f=0;f<c.length;f++)g=c[f],g.enumerable=g.enumerable||!1,g.configurable=!0,'value'in g&&(g.writable=!0),Object.defineProperty(b,g.key,g)}return function(b,c,f){return c&&a(b.prototype,c),f&&a(b,f),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var Graph=function(a){function b(){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.resizeGraph=function(){c.setState({width:Math.max(200,window.innerWidth-50),height:Math.max(200,window.innerHeight-100)},function(){c.centerSim(),c.simulation.alpha(0.3).restart()})},c.centerSim=function(){var _ref=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c.state,f=_ref.width,g=_ref.height,h=600>f?0.25:1e3>f?0.1:0.05,j=400>g?0.5:850>g?0.1:0.05;c.simulation.force('center',d3.forceCenter(f/2,g/2)).force('x',d3.forceX(f/2).strength(h)).force('y',d3.forceY(g/2).strength(j))},c.generateGraph=function(){var h=c.props.data,_this$state=c.state,f=_this$state.width,g=_this$state.height,j=d3.select('svg').attr('width',f).attr('height',g),k=d3.select('body').append('div').attr('class','tooltip'),l=function(q,r,s){k.transition().duration(250).style('opacity',0.9),k.html(q).style('left',r-16+'px').style('top',s-16+'px')},m=function(){k.transition().duration(400).style('opacity',0)};c.simulation=d3.forceSimulation().force('link',d3.forceLink()).force('charge',d3.forceManyBody().strength(-50)),c.centerSim();var n=j.append('g').attr('class','links').selectAll('line').data(h.links).enter().append('line'),o=d3.select('#flags').selectAll('img').data(h.nodes).enter().append('img').attr('src','https://rvrvrv.github.io/img/blank.gif').attr('class',function(q){return'flag flag-'+q.code}).attr('alt',function(q){return q.country}).style('transform','scale('+(500>f||500>g?0.35:0.5)+')').call(d3.drag().on('start',function(q){d3.event.active||c.simulation.alphaTarget(0.5).restart(),q.fx=q.x,q.fy=q.y}).on('drag',function(q){0<d3.event.x&&0<d3.event.y&&d3.event.x<window.innerWidth-64&&d3.event.y<window.innerHeight-100&&(q.fx=d3.event.x,q.fy=d3.event.y)}).on('end',function(q){d3.event.active||c.simulation.alphaTarget(0),q.fx=null,q.fy=null})).on('mouseover',function(q){window.event.buttons||l(q.country,q.x,q.y)}).on('mouseout',function(){m()}).on('click',function(q){l(q.country,q.x,q.y),setTimeout(m,1e3)});c.simulation.nodes(h.nodes).on('tick',function p(){n.attr('x1',function(q){return q.source.x}).attr('y1',function(q){return q.source.y}).attr('x2',function(q){return q.target.x}).attr('y2',function(q){return q.target.y}),o.style('left',function(q){return q.x+'px'}).style('top',function(q){return q.y+48+'px'})}).alpha(0.3),c.simulation.force('link').links(h.links)},c.state={width:Math.max(200,window.innerWidth-50),height:Math.max(200,window.innerHeight-100)},c.simulation=null,c}return _inherits(b,a),_createClass(b,[{key:'componentDidMount',value:function componentDidMount(){this.generateGraph(),window.addEventListener('resize',this.resizeGraph)}},{key:'componentWillUnmount',value:function componentWillUnmount(){window.removeEventListener('resize',this.resizeGraph)}},{key:'render',value:function render(){return React.createElement('div',{className:'graph-wrapper'},React.createElement('svg',{width:this.state.width,height:this.state.height,id:'graphBox'}),React.createElement('div',{id:'flags'}))}}]),b}(React.Component),App=function(a){function b(c){_classCallCheck(this,b);var f=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c));try{f.state={data:forceDirectedData}}catch(g){f.state={data:null}}return f}return _inherits(b,a),_createClass(b,[{key:'render',value:function render(){return React.createElement('div',null,React.createElement('h1',null,'National Contiguity'),React.createElement('h2',null,'Neighboring Countries'),this.state.data?React.createElement(Graph,{data:this.state.data}):React.createElement('h3',null,'An error has occurred. Please try again later.'))}}]),b}(React.Component);ReactDOM.render(React.createElement(App,null),document.getElementById('root'));
