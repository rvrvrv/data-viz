"use strict";document.addEventListener("DOMContentLoaded",function(){function t(t,e,a){h.transition().duration(200).style("opacity",.9),h.html("<h2>"+t.name+"</h2><h3>Year: "+t.year.slice(0,4)+"</h3><h3>Mass: "+t.mass+"</h3>").style("left",(e=e>.7*window.innerWidth?e-150:e)+"px").style("top",(a=a>.6*window.innerHeight?a-200:a+75)+"px")}function e(){h.transition().duration(400).style("opacity",0)}function a(){s.append("g").attr("class","land").selectAll("path").data([topojson.feature(worldMapData,worldMapData.objects.land)]).enter().append("path"),s.append("g").attr("class","boundaries").selectAll("path").data([topojson.feature(worldMapData,worldMapData.objects.countries)]).enter().append("path"),s.selectAll("path").attr("d",r),s.append("g").attr("class","meteorites").selectAll("path").data(meteoriteMapData).enter().append("circle").attr("class","meteorite").attr("cx",function(t){return o(t.geometry.coordinates)[0]}).attr("cy",function(t){return o(t.geometry.coordinates)[1]}).attr("r",function(t){return Math.floor(d(t.properties.mass))}).attr("fill",function(t){return"hsla("+t.properties.year.slice(0,4)+", 80%, 50%, "+c(t.properties.mass)+")"}).on("mouseover",function(e){window.event.buttons||t(e.properties,d3.event.x,d3.event.y)}).on("mouseout",function(t){e()}).on("click",function(a){t(a.properties,d3.event.x,d3.event.y),setTimeout(e,1e3)})}function n(t,e){o=d3.geoMercator().translate([t/2,e/2]).scale(t/2/Math.PI),r=d3.geoPath().projection(o),s=d3.select(".map-container").append("svg").attr("width",t).attr("height",e).attr("class","world-map").call(u).append("g"),i=s.append("g"),a()}var o=void 0,r=void 0,s=void 0,i=void 0,d=d3.scalePow().exponent(.5).domain([.15,23e6]).range([1,80]),c=d3.scalePow().exponent(.5).domain([.15,23e6]).range([.8,.3]),l=document.getElementsByClassName("map-container")[0],p=l.offsetWidth,m=Math.min(.7*p,window.innerHeight-100),h=d3.select("body").append("div").attr("class","tooltip"),u=d3.zoom().scaleExtent([1,9]).on("zoom",function(){var t=[d3.event.transform.x,d3.event.transform.y],e=d3.event.transform.k;t[0]=Math.min(p/m*(e-1),Math.max(p*(1-e),t[0])),t[1]=Math.min(m*(e-1)+m/5*e,Math.max(m*(1-e)-m/5*e,t[1])),s.attr("transform","translate("+t+") scale("+e+")")});d3.select(window).on("resize",function(){p=l.offsetWidth,m=Math.min(.7*p,window.innerHeight-100),d3.select("svg").remove(),n(p,m),a()}),n(p,m)});
