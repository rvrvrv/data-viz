"use strict";function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(a,i){try{var o=e[a](i),s=o.value}catch(t){return void n(t)}if(!o.done)return Promise.resolve(s).then(function(t){return r("next",t)},function(t){return r("throw",t)});t(s)}return r("next")})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Tooltip=function(t){var e=t.x,n=t.y,r=t.info,a=r.time,i=(r.place,r.name,r.year,r.nat,r.doping,r.url,{left:e,top:n});return React.createElement("div",{className:"tooltip",style:i},React.createElement("span",null,"Time: ",a))},Circles=function(t){var e=t.scales,n=t.data,r=e.xScale,a=e.yScale,i=n.map(function(e){return React.createElement("circle",{key:e.Name,cx:r(d3.timeParse("%M:%S")(e.Time)),cy:a(e.Place),r:5,fill:e.Doping?"#e00":"#00d","data-time":e.Time,"data-place":e.Place,"data-name":e.Name,"data-year":e.Year,"data-nat":e.Nationality,"data-doping":e.Doping,"data-url":e.URL,onMouseEnter:t.onHover,onMouseLeave:t.onExitHover})});return React.createElement("g",null,i)},Axis=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(e,t),e.prototype.componentDidMount=function(){this.renderAxis()},e.prototype.componentDidUpdate=function(){this.renderAxis()},e.prototype.renderAxis=function(){if("x"===this.props.axis){var t=d3.axisBottom().scale(this.props.scale).ticks(10).tickSize(this.props.tickSize);d3.select(this.axisElement).call(t)}else{var e=d3.axisLeft().scale(this.props.scale).tickSize(this.props.tickSize);d3.select(this.axisElement).call(e)}},e.prototype.render=function(){var t=this;return React.createElement("g",{className:"axis axis-"+this.props.axis,ref:function(e){t.axisElement=e},transform:this.props.translate})},e}(React.Component),Axes=function(t){var e=t.scales,n=t.margins,r=t.height,a=t.width,i={axis:"x",scale:e.xScale,translate:"translate(0, "+(r-n.bottom)+")",tickSize:-(r-n.top-n.bottom)},o={axis:"y",scale:e.yScale,translate:"translate("+n.left+", 0)",tickSize:-(a-n.left-n.right)};return React.createElement("g",null,React.createElement(Axis,i),React.createElement(Axis,o))},Chart=function(t){function e(){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,t.call(this));return n.showTooltip=function(t){console.log(t.target),n.setState({hovering:t.target.dataset,x:Math.min(window.innerWidth-150,.9*t.target.getAttribute("cx")),y:Math.max(50,.9*t.target.getAttribute("cy"))})},n.hideTooltip=function(){n.setState({hovering:!1})},n.state={hovering:null,x:0,y:0},n}return _inherits(e,t),e.prototype.render=function(){var t=this.props,e=t.height,n=t.width,r=t.data,a={top:10,right:10,bottom:40,left:40},i=d3.extent(r,function(t){return d3.timeParse("%M:%S")(t.Time)}),o=i[0],s=i[1];console.log(o,s);var c=d3.scaleTime(i[0],i[1]).domain([o,s]).range([a.left,n-a.right]),l=d3.scaleLinear().domain([35,1]).range([e-a.bottom,a.top]);return React.createElement("div",null,React.createElement("svg",{width:n,height:e},React.createElement(Axes,{scales:{xScale:c,yScale:l},margins:a,height:e,width:n}),React.createElement(Circles,{scales:{xScale:c,yScale:l},margins:a,data:r,height:e,onHover:this.showTooltip,onExitHover:this.hideTooltip})),this.state.hovering&&React.createElement(Tooltip,{x:this.state.x,y:this.state.y,info:this.state.hovering}))},e}(React.Component),ChartWrapper=function(t){function e(){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,t.call(this));return n.resizeChart=function(){n.setState({height:window.innerHeight-175,width:window.innerWidth-20})},n.state={height:window.innerHeight-175,width:window.innerWidth-20},n}return _inherits(e,t),e.prototype.componentDidMount=function(){window.addEventListener("resize",this.resizeChart)},e.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.resizeChart)},e.prototype.render=function(){return React.createElement(Chart,{height:this.state.height,width:this.state.width,data:this.props.data})},e}(React.Component),App=function(t){function e(n){_classCallCheck(this,e);var r=_possibleConstructorReturn(this,t.call(this,n));return r.state={data:[],status:null},r}return _inherits(e,t),e.prototype.componentDidMount=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e="https://raw.githubusercontent.com/FreeCodeCamp/ProjectReferenceData/master/cyclist-data.json",t.prev=1,t.next=4,fetch(e);case 4:return t.next=6,t.sent.json();case 6:n=t.sent,this.setState({data:n,status:"loaded"}),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),console.error(t.t0),this.setState({status:"error"});case 14:case"end":return t.stop()}},t,this,[[1,10]])}));return function(){return t.apply(this,arguments)}}(),e.prototype.render=function(){return React.createElement("div",null,React.createElement("h1",null,"Cyclist Data"),!this.state.status&&React.createElement("h2",{className:"blinking"},"Retrieving data..."),"error"===this.state.status&&React.createElement("h2",null,"An error has occurred. Please try again later."),"loaded"===this.state.status&&React.createElement(ChartWrapper,{data:this.state.data}),React.createElement("footer",null,"For more information, visit"," ",React.createElement("a",{href:"https://www.dopeology.org/",target:"_blank"},"Dopeology.org")))},e}(React.Component);ReactDOM.render(React.createElement(App,null),document.getElementById("root"));
