"use strict";function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(a,i){try{var o=e[a](i),s=o.value}catch(t){return void n(t)}if(!o.done)return Promise.resolve(s).then(function(t){return r("next",t)},function(t){return r("throw",t)});t(s)}return r("next")})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Tooltip=function(t){var e=t.x,n=t.y,r=t.text;return React.createElement("svg",null,React.createElement("filter",{id:"f1"},React.createElement("feGaussianBlur",{stdDeviation:"5"})),React.createElement("text",{x:e,y:n,style:{stroke:"#f5fff5",strokeWidth:20,filter:"url(#f1)"}},r),React.createElement("text",{x:e,y:n,style:{fill:"#050"}},r))},Bars=function(t){function e(n){_classCallCheck(this,e);var r=_possibleConstructorReturn(this,t.call(this,n));return r.showTooltip=function(t){r.setState({hovering:t.target.dataset.date+": $"+d3.format(",")(t.target.dataset.gdp)+" bn",x:Math.min(window.innerWidth-200,.75*t.target.getAttribute("x")),y:Math.max(40,.9*t.target.getAttribute("y"))})},r.hideTooltip=function(){r.setState({hovering:!1})},r.state={hovering:!1,x:0,y:0},r.colorScale=d3.scaleLinear().domain([0,r.props.maxValue]).range(["#ac7","#5a1"]).interpolate(d3.interpolateLab),r}return _inherits(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.scales,r=e.margins,a=e.data,i=e.height,o=n.xScale,s=n.yScale,c=a.map(function(e){return React.createElement("rect",{key:e[0],x:o(e[0]),y:s(e[1]),height:i-r.bottom-n.yScale(e[1]),width:o.bandwidth()+1,fill:t.colorScale(e[1]),"data-date":e[0],"data-gdp":e[1],onMouseEnter:t.showTooltip,onMouseLeave:t.hideTooltip})});return React.createElement("svg",null,React.createElement("g",null,c),this.state.hovering&&React.createElement(Tooltip,{x:this.state.x,y:this.state.y,text:this.state.hovering}))},e}(React.Component),Axis=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(e,t),e.prototype.componentDidMount=function(){this.renderAxis()},e.prototype.componentDidUpdate=function(){this.renderAxis()},e.prototype.renderAxis=function(){if("x"===this.props.axis){var t=d3.axisBottom().scale(this.props.scale).tickSize(this.props.tickSize).tickValues(["Jan 1950","Jan 1960","Jan 1970","Jan 1980","Jan 1990","Jan 2000","Jan 2010"]);d3.select(this.axisElement).call(t)}else{var e=d3.axisLeft().scale(this.props.scale).tickSize(this.props.tickSize).tickValues([6e3,12e3]).tickFormat(function(t){return"$"+t/1e3+"k bn"});d3.select(this.axisElement).call(e)}},e.prototype.render=function(){var t=this;return React.createElement("g",{className:"axis axis-"+this.props.axis,ref:function(e){t.axisElement=e},transform:this.props.translate})},e}(React.Component),Axes=function(t){var e=t.scales,n=t.margins,r=t.height,a=t.width,i={axis:"x",scale:e.xScale,translate:"translate(0, "+(r-n.bottom)+")",tickSize:0},o={axis:"y",scale:e.yScale,translate:"translate("+n.left+", 0)",tickSize:-(a-n.left-n.right)};return React.createElement("g",null,React.createElement(Axis,i),React.createElement(Axis,o))},Chart=function(t){var e=t.height,n=t.width,r=t.data,a={top:3,right:10,bottom:40,left:40},i=d3.max(r.map(function(t){return t[1]})),o=d3.scaleBand().domain(r.map(function(t){return t[0]})).range([a.left+1,n-a.right-1]),s=d3.scaleLinear().domain([0,i+10]).range([e-a.bottom,a.top]);return React.createElement("svg",{width:n,height:e},React.createElement(Axes,{scales:{xScale:o,yScale:s},margins:a,height:e,width:n}),React.createElement(Bars,{scales:{xScale:o,yScale:s},margins:a,data:r,maxValue:i,height:e}))},ChartWrapper=function(t){function e(){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,t.call(this));return n.resizeChart=function(){n.setState({height:window.innerHeight-175,width:window.innerWidth-20})},n.state={height:window.innerHeight-175,width:window.innerWidth-20},n}return _inherits(e,t),e.prototype.componentDidMount=function(){window.addEventListener("resize",this.resizeChart)},e.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.resizeChart)},e.prototype.render=function(){return React.createElement(Chart,{height:this.state.height,width:this.state.width,data:this.props.data})},e}(React.Component),App=function(t){function e(n){_classCallCheck(this,e);var r=_possibleConstructorReturn(this,t.call(this,n));return r.state={data:[],status:null},r}return _inherits(e,t),e.prototype.componentDidMount=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e="https://raw.githubusercontent.com/FreeCodeCamp/ProjectReferenceData/master/GDP-data.json",t.prev=1,t.next=4,fetch(e);case 4:return t.next=6,t.sent.json();case 6:n=t.sent,r=n.data.map(function(t){return[d3.timeFormat("%b %Y")(d3.timeParse("%Y-%m-%d")(t[0])),t[1]]}),this.setState({data:r,status:"loaded"}),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),console.error(t.t0),this.setState({status:"error"});case 15:case"end":return t.stop()}},t,this,[[1,11]])}));return function(){return t.apply(this,arguments)}}(),e.prototype.render=function(){return React.createElement("div",null,React.createElement("h1",null,"US Quarterly GDP"),!this.state.status&&React.createElement("h2",{className:"blinking"},"Retrieving data..."),"error"===this.state.status&&React.createElement("h2",null,"An error has occurred. Please try again later."),"loaded"===this.state.status&&React.createElement(ChartWrapper,{data:this.state.data}),React.createElement("footer",null,"For more information, visit the"," ",React.createElement("a",{href:"https://bea.gov/methodologies/index.htm",target:"_blank"},"U.S. Department of Commerce Bureau of Economic Analysis (BEA)")))},e}(React.Component);ReactDOM.render(React.createElement(App,null),document.getElementById("root"));
